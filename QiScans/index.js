"use strict";var source=(()=>{var oi=Object.create;var ie=Object.defineProperty;var si=Object.getOwnPropertyDescriptor;var ai=Object.getOwnPropertyNames;var ci=Object.getPrototypeOf,ui=Object.prototype.hasOwnProperty;var li=(r,e)=>()=>(r&&(e=r(r=0)),e);var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),pi=(r,e)=>{for(var t in e)ie(r,t,{get:e[t],enumerable:!0})},et=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ai(e))!ui.call(r,n)&&n!==t&&ie(r,n,{get:()=>e[n],enumerable:!(i=si(e,n))||i.enumerable});return r};var T=(r,e,t)=>(t=r!=null?oi(ci(r)):{},et(e||!r||!r.__esModule?ie(t,"default",{value:r,enumerable:!0}):t,r)),fi=r=>et(ie({},"__esModule",{value:!0}),r);var it=m(ne=>{"use strict";a();ne.byteLength=di;ne.toByteArray=mi;ne.fromByteArray=wi;var Q=[],b=[],hi=typeof Uint8Array<"u"?Uint8Array:Array,Be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(L=0,tt=Be.length;L<tt;++L)Q[L]=Be[L],b[Be.charCodeAt(L)]=L;var L,tt;b[45]=62;b[95]=63;function rt(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function di(r){var e=rt(r),t=e[0],i=e[1];return(t+i)*3/4-i}function gi(r,e,t){return(e+t)*3/4-t}function mi(r){var e,t=rt(r),i=t[0],n=t[1],o=new hi(gi(r,i,n)),s=0,u=n>0?i-4:i,l;for(l=0;l<u;l+=4)e=b[r.charCodeAt(l)]<<18|b[r.charCodeAt(l+1)]<<12|b[r.charCodeAt(l+2)]<<6|b[r.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return n===2&&(e=b[r.charCodeAt(l)]<<2|b[r.charCodeAt(l+1)]>>4,o[s++]=e&255),n===1&&(e=b[r.charCodeAt(l)]<<10|b[r.charCodeAt(l+1)]<<4|b[r.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function yi(r){return Q[r>>18&63]+Q[r>>12&63]+Q[r>>6&63]+Q[r&63]}function Ii(r,e,t){for(var i,n=[],o=e;o<t;o+=3)i=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),n.push(yi(i));return n.join("")}function wi(r){for(var e,t=r.length,i=t%3,n=[],o=16383,s=0,u=t-i;s<u;s+=o)n.push(Ii(r,s,s+o>u?u:s+o));return i===1?(e=r[t-1],n.push(Q[e>>2]+Q[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(Q[e>>10]+Q[e>>4&63]+Q[e<<2&63]+"=")),n.join("")}});var nt=m(be=>{a();be.read=function(r,e,t,i,n){var o,s,u=n*8-i-1,l=(1<<u)-1,f=l>>1,h=-7,p=t?n-1:0,S=t?-1:1,I=r[e+p];for(p+=S,o=I&(1<<-h)-1,I>>=-h,h+=u;h>0;o=o*256+r[e+p],p+=S,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=i;h>0;s=s*256+r[e+p],p+=S,h-=8);if(o===0)o=1-f;else{if(o===l)return s?NaN:(I?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-f}return(I?-1:1)*s*Math.pow(2,o-i)};be.write=function(r,e,t,i,n,o){var s,u,l,f=o*8-n-1,h=(1<<f)-1,p=h>>1,S=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=i?0:o-1,g=i?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+p>=1?e+=S/l:e+=S*Math.pow(2,1-p),e*l>=2&&(s++,l/=2),s+p>=h?(u=0,s=h):s+p>=1?(u=(e*l-1)*Math.pow(2,n),s=s+p):(u=e*Math.pow(2,p-1)*Math.pow(2,n),s=0));n>=8;r[t+I]=u&255,I+=g,u/=256,n-=8);for(s=s<<n|u,f+=n;f>0;r[t+I]=s&255,I+=g,s/=256,f-=8);r[t+I-g]|=y*128}});var xt=m(z=>{"use strict";a();var Ce=it(),V=nt(),ot=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;z.Buffer=c;z.SlowBuffer=Pi;z.INSPECT_MAX_BYTES=50;var oe=2147483647;z.kMaxLength=oe;c.TYPED_ARRAY_SUPPORT=Si();!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Si(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}});Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function q(r){if(r>oe)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,c.prototype),e}function c(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Fe(r)}return ut(r,e,t)}c.poolSize=8192;function ut(r,e,t){if(typeof r=="string")return Ei(r,e);if(ArrayBuffer.isView(r))return Ri(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(U(r,ArrayBuffer)||r&&U(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(U(r,SharedArrayBuffer)||r&&U(r.buffer,SharedArrayBuffer)))return $e(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return c.from(i,e,t);let n=_i(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return c.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}c.from=function(r,e,t){return ut(r,e,t)};Object.setPrototypeOf(c.prototype,Uint8Array.prototype);Object.setPrototypeOf(c,Uint8Array);function lt(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function xi(r,e,t){return lt(r),r<=0?q(r):e!==void 0?typeof t=="string"?q(r).fill(e,t):q(r).fill(e):q(r)}c.alloc=function(r,e,t){return xi(r,e,t)};function Fe(r){return lt(r),q(r<0?0:Qe(r)|0)}c.allocUnsafe=function(r){return Fe(r)};c.allocUnsafeSlow=function(r){return Fe(r)};function Ei(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=pt(r,e)|0,i=q(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function Ae(r){let e=r.length<0?0:Qe(r.length)|0,t=q(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function Ri(r){if(U(r,Uint8Array)){let e=new Uint8Array(r);return $e(e.buffer,e.byteOffset,e.byteLength)}return Ae(r)}function $e(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,c.prototype),i}function _i(r){if(c.isBuffer(r)){let e=Qe(r.length)|0,t=q(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Oe(r.length)?q(0):Ae(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Ae(r.data)}function Qe(r){if(r>=oe)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+oe.toString(16)+" bytes");return r|0}function Pi(r){return+r!=r&&(r=0),c.alloc(+r)}c.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==c.prototype};c.compare=function(e,t){if(U(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),U(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let o=0,s=Math.min(i,n);o<s;++o)if(e[o]!==t[o]){i=e[o],n=t[o];break}return i<n?-1:n<i?1:0};c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return c.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=c.allocUnsafe(t),o=0;for(i=0;i<e.length;++i){let s=e[i];if(U(s,Uint8Array))o+s.length>n.length?(c.isBuffer(s)||(s=c.from(s)),s.copy(n,o)):Uint8Array.prototype.set.call(n,s,o);else if(c.isBuffer(s))s.copy(n,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return n};function pt(r,e){if(c.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||U(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Me(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return St(r).length;default:if(n)return i?-1:Me(r).length;e=(""+e).toLowerCase(),n=!0}}c.byteLength=pt;function Bi(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return vi(this,e,t);case"utf8":case"utf-8":return ht(this,e,t);case"ascii":return Ui(this,e,t);case"latin1":case"binary":return Oi(this,e,t);case"base64":return Fi(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ti(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}c.prototype._isBuffer=!0;function j(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}c.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)j(this,t,t+1);return this};c.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)j(this,t,t+3),j(this,t+1,t+2);return this};c.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)j(this,t,t+7),j(this,t+1,t+6),j(this,t+2,t+5),j(this,t+3,t+4);return this};c.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?ht(this,0,e):Bi.apply(this,arguments)};c.prototype.toLocaleString=c.prototype.toString;c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:c.compare(this,e)===0};c.prototype.inspect=function(){let e="",t=z.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};ot&&(c.prototype[ot]=c.prototype.inspect);c.prototype.compare=function(e,t,i,n,o){if(U(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),o===void 0&&(o=this.length),t<0||i>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=i)return 0;if(n>=o)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,o>>>=0,this===e)return 0;let s=o-n,u=i-t,l=Math.min(s,u),f=this.slice(n,o),h=e.slice(t,i);for(let p=0;p<l;++p)if(f[p]!==h[p]){s=f[p],u=h[p];break}return s<u?-1:u<s?1:0};function ft(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Oe(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=c.from(e,i)),c.isBuffer(e))return e.length===0?-1:st(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):st(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function st(r,e,t,i,n){let o=1,s=r.length,u=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;o=2,s/=2,u/=2,t/=2}function l(h,p){return o===1?h[p]:h.readUInt16BE(p*o)}let f;if(n){let h=-1;for(f=t;f<s;f++)if(l(r,f)===l(e,h===-1?0:f-h)){if(h===-1&&(h=f),f-h+1===u)return h*o}else h!==-1&&(f-=f-h),h=-1}else for(t+u>s&&(t=s-u),f=t;f>=0;f--){let h=!0;for(let p=0;p<u;p++)if(l(r,f+p)!==l(e,p)){h=!1;break}if(h)return f}return-1}c.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};c.prototype.indexOf=function(e,t,i){return ft(this,e,t,i,!0)};c.prototype.lastIndexOf=function(e,t,i){return ft(this,e,t,i,!1)};function bi(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let o=e.length;i>o/2&&(i=o/2);let s;for(s=0;s<i;++s){let u=parseInt(e.substr(s*2,2),16);if(Oe(u))return s;r[t+s]=u}return s}function Ci(r,e,t,i){return se(Me(e,r.length-t),r,t,i)}function Ai(r,e,t,i){return se(Di(e),r,t,i)}function $i(r,e,t,i){return se(St(e),r,t,i)}function Mi(r,e,t,i){return se(Li(e,r.length-t),r,t,i)}c.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-t;if((i===void 0||i>o)&&(i=o),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return bi(this,e,t,i);case"utf8":case"utf-8":return Ci(this,e,t,i);case"ascii":case"latin1":case"binary":return Ai(this,e,t,i);case"base64":return $i(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mi(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Fi(r,e,t){return e===0&&t===r.length?Ce.fromByteArray(r):Ce.fromByteArray(r.slice(e,t))}function ht(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let o=r[n],s=null,u=o>239?4:o>223?3:o>191?2:1;if(n+u<=t){let l,f,h,p;switch(u){case 1:o<128&&(s=o);break;case 2:l=r[n+1],(l&192)===128&&(p=(o&31)<<6|l&63,p>127&&(s=p));break;case 3:l=r[n+1],f=r[n+2],(l&192)===128&&(f&192)===128&&(p=(o&15)<<12|(l&63)<<6|f&63,p>2047&&(p<55296||p>57343)&&(s=p));break;case 4:l=r[n+1],f=r[n+2],h=r[n+3],(l&192)===128&&(f&192)===128&&(h&192)===128&&(p=(o&15)<<18|(l&63)<<12|(f&63)<<6|h&63,p>65535&&p<1114112&&(s=p))}}s===null?(s=65533,u=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),n+=u}return Qi(i)}var at=4096;function Qi(r){let e=r.length;if(e<=at)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=at));return t}function Ui(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function Oi(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function vi(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let o=e;o<t;++o)n+=ji[r[o]];return n}function Ti(r,e,t){let i=r.slice(e,t),n="";for(let o=0;o<i.length-1;o+=2)n+=String.fromCharCode(i[o]+i[o+1]*256);return n}c.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n};function R(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||R(e,t,this.length);let n=this[e],o=1,s=0;for(;++s<t&&(o*=256);)n+=this[e+s]*o;return n};c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||R(e,t,this.length);let n=this[e+--t],o=1;for(;t>0&&(o*=256);)n+=this[e+--t]*o;return n};c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e=e>>>0,t||R(e,1,this.length),this[e]};c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||R(e,2,this.length),this[e]|this[e+1]<<8};c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||R(e,2,this.length),this[e]<<8|this[e+1]};c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||R(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};c.prototype.readBigUInt64LE=N(function(e){e=e>>>0,W(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&X(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))});c.prototype.readBigUInt64BE=N(function(e){e=e>>>0,W(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&X(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(o)});c.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||R(e,t,this.length);let n=this[e],o=1,s=0;for(;++s<t&&(o*=256);)n+=this[e+s]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n};c.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||R(e,t,this.length);let n=t,o=1,s=this[e+--n];for(;n>0&&(o*=256);)s+=this[e+--n]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s};c.prototype.readInt8=function(e,t){return e=e>>>0,t||R(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};c.prototype.readInt16LE=function(e,t){e=e>>>0,t||R(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};c.prototype.readInt16BE=function(e,t){e=e>>>0,t||R(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};c.prototype.readInt32LE=function(e,t){return e=e>>>0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};c.prototype.readInt32BE=function(e,t){return e=e>>>0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};c.prototype.readBigInt64LE=N(function(e){e=e>>>0,W(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&X(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});c.prototype.readBigInt64BE=N(function(e){e=e>>>0,W(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&X(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});c.prototype.readFloatLE=function(e,t){return e=e>>>0,t||R(e,4,this.length),V.read(this,e,!0,23,4)};c.prototype.readFloatBE=function(e,t){return e=e>>>0,t||R(e,4,this.length),V.read(this,e,!1,23,4)};c.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||R(e,8,this.length),V.read(this,e,!0,52,8)};c.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||R(e,8,this.length),V.read(this,e,!1,52,8)};function P(r,e,t,i,n,o){if(!c.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let u=Math.pow(2,8*i)-1;P(this,e,t,i,u,0)}let o=1,s=0;for(this[t]=e&255;++s<i&&(o*=256);)this[t+s]=e/o&255;return t+i};c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let u=Math.pow(2,8*i)-1;P(this,e,t,i,u,0)}let o=i-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+i};c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,1,255,0),this[t]=e&255,t+1};c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function dt(r,e,t,i,n){wt(e,i,n,r,t,7);let o=Number(e&BigInt(4294967295));r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,t}function gt(r,e,t,i,n){wt(e,i,n,r,t,7);let o=Number(e&BigInt(4294967295));r[t+7]=o,o=o>>8,r[t+6]=o,o=o>>8,r[t+5]=o,o=o>>8,r[t+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=s,s=s>>8,r[t+2]=s,s=s>>8,r[t+1]=s,s=s>>8,r[t]=s,t+8}c.prototype.writeBigUInt64LE=N(function(e,t=0){return dt(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeBigUInt64BE=N(function(e,t=0){return gt(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let l=Math.pow(2,8*i-1);P(this,e,t,i,l-1,-l)}let o=0,s=1,u=0;for(this[t]=e&255;++o<i&&(s*=256);)e<0&&u===0&&this[t+o-1]!==0&&(u=1),this[t+o]=(e/s>>0)-u&255;return t+i};c.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let l=Math.pow(2,8*i-1);P(this,e,t,i,l-1,-l)}let o=i-1,s=1,u=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&u===0&&this[t+o+1]!==0&&(u=1),this[t+o]=(e/s>>0)-u&255;return t+i};c.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};c.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};c.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};c.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};c.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};c.prototype.writeBigInt64LE=N(function(e,t=0){return dt(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});c.prototype.writeBigInt64BE=N(function(e,t=0){return gt(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function mt(r,e,t,i,n,o){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function yt(r,e,t,i,n){return e=+e,t=t>>>0,n||mt(r,e,t,4,34028234663852886e22,-34028234663852886e22),V.write(r,e,t,i,23,4),t+4}c.prototype.writeFloatLE=function(e,t,i){return yt(this,e,t,!0,i)};c.prototype.writeFloatBE=function(e,t,i){return yt(this,e,t,!1,i)};function It(r,e,t,i,n){return e=+e,t=t>>>0,n||mt(r,e,t,8,17976931348623157e292,-17976931348623157e292),V.write(r,e,t,i,52,8),t+8}c.prototype.writeDoubleLE=function(e,t,i){return It(this,e,t,!0,i)};c.prototype.writeDoubleBE=function(e,t,i){return It(this,e,t,!1,i)};c.prototype.copy=function(e,t,i,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let o=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),o};c.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let s=e.charCodeAt(0);(n==="utf8"&&s<128||n==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let o;if(typeof e=="number")for(o=t;o<i;++o)this[o]=e;else{let s=c.isBuffer(e)?e:c.from(e,n),u=s.length;if(u===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<i-t;++o)this[o+t]=s[o%u]}return this};var J={};function Ue(r,e,t){J[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Ue("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ue("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);Ue("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=ct(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=ct(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function ct(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function qi(r,e,t){W(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&X(e,r.length-(t+1))}function wt(r,e,t,i,n,o){if(r>t||r<e){let s=typeof e=="bigint"?"n":"",u;throw o>3?e===0||e===BigInt(0)?u=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:u=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:u=`>= ${e}${s} and <= ${t}${s}`,new J.ERR_OUT_OF_RANGE("value",u,r)}qi(i,n,o)}function W(r,e){if(typeof r!="number")throw new J.ERR_INVALID_ARG_TYPE(e,"number",r)}function X(r,e,t){throw Math.floor(r)!==r?(W(r,t),new J.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new J.ERR_BUFFER_OUT_OF_BOUNDS:new J.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var ki=/[^+/0-9A-Za-z-_]/g;function Ni(r){if(r=r.split("=")[0],r=r.trim().replace(ki,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Me(r,e){e=e||1/0;let t,i=r.length,n=null,o=[];for(let s=0;s<i;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Di(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Li(r,e){let t,i,n,o=[];for(let s=0;s<r.length&&!((e-=2)<0);++s)t=r.charCodeAt(s),i=t>>8,n=t%256,o.push(n),o.push(i);return o}function St(r){return Ce.toByteArray(Ni(r))}function se(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function U(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Oe(r){return r!==r}var ji=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function N(r){return typeof BigInt>"u"?Hi:r}function Hi(){throw new Error("BigInt not supported")}});var d,a=li(()=>{d=xt().Buffer});var Et=m(ae=>{"use strict";a();Object.defineProperty(ae,"__esModule",{value:!0});ae.Form=void 0;var ve=class{reloadForm(){let e=this.__underlying_formId;e&&Application.formDidChange(e)}get requiresExplicitSubmission(){return!1}};ae.Form=ve});var Rt=m(C=>{"use strict";a();Object.defineProperty(C,"__esModule",{value:!0});C.LabelRow=Gi;C.InputRow=Ji;C.StepperRow=Vi;C.ToggleRow=Wi;C.SelectRow=zi;C.ButtonRow=Ki;C.WebViewRow=Yi;C.NavigationRow=Xi;C.OAuthButtonRow=Zi;C.DeferredItem=en;function Gi(r,e){return{...e,id:r,type:"labelRow",isHidden:e.isHidden??!1}}function Ji(r,e){return{...e,id:r,type:"inputRow",isHidden:e.isHidden??!1}}function Vi(r,e){return{...e,id:r,type:"stepperRow",isHidden:e.isHidden??!1}}function Wi(r,e){return{...e,id:r,type:"toggleRow",isHidden:e.isHidden??!1}}function zi(r,e){return{...e,id:r,type:"selectRow",isHidden:e.isHidden??!1}}function Ki(r,e){return{...e,id:r,type:"buttonRow",isHidden:e.isHidden??!1}}function Yi(r,e){return{...e,id:r,type:"webViewRow",isHidden:e.isHidden??!1}}function Xi(r,e){return{...e,id:r,type:"navigationRow",isHidden:e.isHidden??!1}}function Zi(r,e){return{...e,id:r,type:"oauthButtonRow",isHidden:e.isHidden??!1}}function en(r){return r()}});var _t=m(Te=>{"use strict";a();Object.defineProperty(Te,"__esModule",{value:!0});Te.Section=tn;function tn(r,e){let t;return typeof r=="string"?t={id:r}:t=r,{...t,items:e.filter(i=>i)}}});var Pt=m(k=>{"use strict";a();var rn=k&&k.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),qe=k&&k.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&rn(e,r,t)};Object.defineProperty(k,"__esModule",{value:!0});qe(Et(),k);qe(Rt(),k);qe(_t(),k)});var bt=m(Bt=>{"use strict";a();Object.defineProperty(Bt,"__esModule",{value:!0})});var At=m(Ct=>{"use strict";a();Object.defineProperty(Ct,"__esModule",{value:!0})});var Mt=m($t=>{"use strict";a();Object.defineProperty($t,"__esModule",{value:!0})});var Qt=m(Ft=>{"use strict";a();Object.defineProperty(Ft,"__esModule",{value:!0})});var Ot=m(Ut=>{"use strict";a();Object.defineProperty(Ut,"__esModule",{value:!0})});var Tt=m(vt=>{"use strict";a();Object.defineProperty(vt,"__esModule",{value:!0})});var kt=m(qt=>{"use strict";a();Object.defineProperty(qt,"__esModule",{value:!0})});var Dt=m(Nt=>{"use strict";a();Object.defineProperty(Nt,"__esModule",{value:!0})});var Lt=m(B=>{"use strict";a();var nn=B&&B.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),D=B&&B.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&nn(e,r,t)};Object.defineProperty(B,"__esModule",{value:!0});D(bt(),B);D(At(),B);D(Mt(),B);D(Qt(),B);D(Ot(),B);D(Tt(),B);D(kt(),B);D(Dt(),B)});var Ht=m(jt=>{"use strict";a();Object.defineProperty(jt,"__esModule",{value:!0})});var ue=m(ce=>{"use strict";a();Object.defineProperty(ce,"__esModule",{value:!0});ce.PaperbackInterceptor=void 0;var ke=class{id;constructor(e){this.id=e}registerInterceptor(){Application.registerInterceptor(this.id,Application.Selector(this,"interceptRequest"),Application.Selector(this,"interceptResponse"))}unregisterInterceptor(){Application.unregisterInterceptor(this.id)}};ce.PaperbackInterceptor=ke});var Jt=m(Gt=>{"use strict";a();Object.defineProperty(Gt,"__esModule",{value:!0})});var Wt=m(Vt=>{"use strict";a();Object.defineProperty(Vt,"__esModule",{value:!0})});var zt=m(H=>{"use strict";a();Object.defineProperty(H,"__esModule",{value:!0});H.unlock=H.lock=void 0;var le={},Ne={},on=async r=>{if(le[r]){await le[r],await(0,H.lock)(r);return}le[r]=new Promise(e=>Ne[r]=()=>{delete le[r],e()})};H.lock=on;var sn=r=>{Ne[r]&&Ne[r]()};H.unlock=sn});var Yt=m(pe=>{"use strict";a();Object.defineProperty(pe,"__esModule",{value:!0});pe.BasicRateLimiter=void 0;var Kt=zt(),an=ue(),De=class extends an.PaperbackInterceptor{options;promise;currentRequestsMade=0;lastReset=Date.now();imageRegex=new RegExp(/\.(png|gif|jpeg|jpg|webp)(\?|$)/i);constructor(e,t){super(e),this.options=t}async interceptRequest(e){return this.options.ignoreImages&&this.imageRegex.test(e.url)||(await(0,Kt.lock)(this.id),await this.incrementRequestCount(),(0,Kt.unlock)(this.id)),e}async interceptResponse(e,t,i){return i}async incrementRequestCount(){if(await this.promise,(Date.now()-this.lastReset)/1e3>this.options.bufferInterval&&(this.currentRequestsMade=0,this.lastReset=Date.now()),this.currentRequestsMade+=1,this.currentRequestsMade>=this.options.numberOfRequests){let t=(Date.now()-this.lastReset)/1e3;if(t<=this.options.bufferInterval){let i=this.options.bufferInterval-t;console.log(`[BasicRateLimiter] rate limit hit, sleeping for ${i}`),this.promise=Application.sleep(i)}}}};pe.BasicRateLimiter=De});var Xt=m(fe=>{"use strict";a();Object.defineProperty(fe,"__esModule",{value:!0});fe.CloudflareError=void 0;var Le=class extends Error{resolutionRequest;type="cloudflareError";constructor(e,t="Cloudflare bypass is required"){super(t),this.resolutionRequest=e}};fe.CloudflareError=Le});var Ge=m(Z=>{"use strict";a();Object.defineProperty(Z,"__esModule",{value:!0});Z.URL=void 0;Z.parseURL=je;function je(r){let e={},t=/^(?:([a-zA-Z][a-zA-Z\d+\-.]*):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,i=r.match(t);if(!i)throw new Error("Invalid URL string provided.");if(i[1]!==void 0&&i[1]!==""&&(e.protocol=i[1]),i[2]!==void 0&&i[2]!==""){let n=i[2],o="",s="",u=n.indexOf("@");if(u!==-1){if(o=n.substring(0,u),s=n.substring(u+1),o!==""){let l=o.indexOf(":");l!==-1?(e.username=o.substring(0,l),e.password=o.substring(l+1)):(e.username=o,e.password="")}}else s=n;if(s!=="")if(s.startsWith("[")){let l=s.indexOf("]");if(l===-1)throw new Error("Invalid IPv6 address in URL update.");e.hostname=s.substring(0,l+1);let f=s.substring(l+1);f.startsWith(":")&&(e.port=f.substring(1))}else{let l=s.lastIndexOf(":");l!==-1&&s.indexOf(":")===l?(e.hostname=s.substring(0,l),e.port=s.substring(l+1)):(e.hostname=s,e.port="")}}if(i[3]!==void 0&&i[3]!==""&&(e.path=i[3].startsWith("/")?i[3]:`/${i[3]}`),i[4]!==void 0){let n={},o=i[4].split("&");for(let s of o){if(!s)continue;let[u,l=""]=s.split("="),f=decodeURIComponent(u),h=decodeURIComponent(l);if(f in n){let p=n[f];Array.isArray(p)?p.push(h):n[f]=[p,h]}else n[f]=h}e.queryItems=n}return i[5]!==void 0&&(e.fragment=i[5]),e}var He=class{protocol;hostname;path;username;password;port;queryItems={};fragment;constructor(e){let t=je(e);if(!t.hostname||!t.protocol)throw new Error("URL Hostname and Protocol are required");this.hostname=t.hostname,this.protocol=t.protocol,this.path=t.path??"",this.username=t.username,this.password=t.password,this.port=t.port,this.queryItems=t.queryItems,this.fragment=t.fragment}toString(){let e=`${this.protocol}://`;if(this.username!==void 0&&this.username!==""&&(e+=this.username,this.password!==void 0&&this.password!==""&&(e+=`:${this.password}`),e+="@"),e+=this.hostname,this.port!==void 0&&this.port!==""&&(e+=`:${this.port}`),this.path!==""&&(e+=this.path.startsWith("/")?this.path:`/${this.path}`),this.queryItems!==void 0){let t=Object.keys(this.queryItems),i=[];if(t.length>0)for(let n of t){let o=this.queryItems[n];if(Array.isArray(o))for(let s of o)i.push(`${encodeURIComponent(n)}=${encodeURIComponent(s)}`);else i.push(`${encodeURIComponent(n)}=${encodeURIComponent(o)}`)}e+=`?${i.join("&")}`}return this.fragment!==void 0&&(e+=`#${this.fragment}`),e}setProtocol(e){if(e==="")throw new Error("Protocol is required");return this.protocol=e,this}setUsername(e){return e===""?this.username=void 0:this.username=e,this}setPassword(e){return e===""?this.password=void 0:this.password=e,this}setHostname(e){if(e==="")throw new Error("Hostname is required");return this.hostname=e,this}setPort(e){return e===""?this.port=void 0:this.port=e,this}setPath(e){return this.path=e.startsWith("/")?e:`/${e}`,this}addPathComponent(e){return this.path=(this.path??"")+(e.startsWith("/")?e:`/${e}`),this}setQueryItems(e){return this.queryItems=e,this}setQueryItem(e,t){return this.queryItems===void 0&&(this.queryItems={}),this.queryItems[e]=t,this}removeQueryItem(e){return delete this.queryItems?.[e],this}setFragment(e){return this.fragment=e,this}update(e){let t;return typeof e=="string"?t=je(e):t=e,t.protocol!==void 0&&this.setProtocol(t.protocol),t.username!==void 0&&this.setUsername(t.username),t.password!==void 0&&this.setPassword(t.password),t.hostname!==void 0&&this.setHostname(t.hostname),t.port!==void 0&&this.setPort(t.port),t.path!==void 0&&this.setPath(t.path),t.queryItems!==void 0&&this.setQueryItems(t.queryItems),t.fragment!==void 0&&this.setFragment(t.fragment),this}};Z.URL=He});var er=m(he=>{"use strict";a();Object.defineProperty(he,"__esModule",{value:!0});he.CookieStorageInterceptor=void 0;var cn=ue(),un=Ge(),Zt="cookie_store_cookies",Je=class extends cn.PaperbackInterceptor{options;_cookies={};get cookies(){return Object.freeze(Object.values(this._cookies))}set cookies(e){let t={};for(let i of e)this.isCookieExpired(i)||(t[this.cookieIdentifier(i)]=i);this._cookies=t,this.saveCookiesToStorage()}constructor(e){super("cookie_store"),this.options=e,this.loadCookiesFromStorage()}async interceptRequest(e){return e.cookies={...e.cookies??{},...this.cookiesForUrl(e.url).reduce((t,i)=>(t[i.name]=i.value,t),{})},e}async interceptResponse(e,t,i){let n=this._cookies;for(let o of t.cookies){let s=this.cookieIdentifier(o);if(this.isCookieExpired(o)){delete n[s];continue}n[s]=o}return this._cookies=n,this.saveCookiesToStorage(),i}setCookie(e){this.isCookieExpired(e)||(this._cookies[this.cookieIdentifier(e)]=e,this.saveCookiesToStorage())}deleteCookie(e){delete this._cookies[this.cookieIdentifier(e)]}cookiesForUrl(e){console.log("[COMPAT] COOKIES FOR URL");let t=new un.URL(e),i=t.hostname;if(!i)return[];let n={},o=t.path.startsWith("/")?t.path:`/${t.path}`,s=i.split("."),u=o.split("/");u.shift();let l=this.cookies;for(let f of l){if(this.isCookieExpired(f)){delete this._cookies[this.cookieIdentifier(f)];continue}let p=this.cookieSanitizedDomain(f).split(".");if(s.length<p.length||p.length==0)continue;let S=!0;for(let E=0;E<p.length;E++){let v=p.length-1-E,Pe=s.length-1-E;if(p[v]!=s[Pe]){S=!1;break}}if(!S)continue;let I=this.cookieSanitizedPath(f),g=I.split("/");g.shift();let y=0;if(o===I)y=Number.MAX_SAFE_INTEGER;else if(g.length===0||I==="/")y=1;else if(o.startsWith(I)&&u.length>=g.length)for(let E=0;E<g.length&&g[E]===u[E];E++)y+=1;y<=0||(n[f.name]?.pathMatches??0)<y&&(n[f.name]={cookie:f,pathMatches:y})}return Object.values(n).map(f=>f.cookie)}cookieIdentifier(e){return`${e.name}-${this.cookieSanitizedDomain(e)}-${this.cookieSanitizedPath(e)}`}cookieSanitizedPath(e){return e.path?.startsWith("/")?e.path:"/"+(e.path??"")}cookieSanitizedDomain(e){return e.domain.replace(/^(www)?\.?/gi,"").toLowerCase()}isCookieExpired(e){return!!(e.expires&&e.expires.getTime()<=Date.now())}loadCookiesFromStorage(){if(this.options.storage=="memory")return;let e=Application.getState(Zt);if(!e){this._cookies={};return}let t={};for(let i of e)!i.expires||this.isCookieExpired(i)||(t[this.cookieIdentifier(i)]=i);this._cookies=t}saveCookiesToStorage(){this.options.storage!="memory"&&Application.setState(this.cookies.filter(e=>e.expires),Zt)}};he.CookieStorageInterceptor=Je});var tr=m(We=>{"use strict";a();Object.defineProperty(We,"__esModule",{value:!0});We.createFormState=ln;var Ve=class{form;_value;_selector;constructor(e,t){this.form=e,this._value=t,this._selector=Application.Selector(this,"updateValue")}get value(){return this._value}get selector(){return this._selector}async updateValue(e){this._value=e,this.form.reloadForm()}};function ln(r,e){let t=new Ve(r,e);return[()=>t.value,t.updateValue.bind(t),t.selector]}});var rr=m(_=>{"use strict";a();var pn=_&&_.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),$=_&&_.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pn(e,r,t)};Object.defineProperty(_,"__esModule",{value:!0});$(Pt(),_);$(Lt(),_);$(Ht(),_);$(ue(),_);$(Jt(),_);$(Wt(),_);$(Yt(),_);$(Xt(),_);$(er(),_);$(tr(),_);$(Ge(),_)});var nr=m(ir=>{"use strict";a();Object.defineProperty(ir,"__esModule",{value:!0})});var sr=m(or=>{"use strict";a();Object.defineProperty(or,"__esModule",{value:!0})});var cr=m(ar=>{"use strict";a();Object.defineProperty(ar,"__esModule",{value:!0})});var lr=m(ur=>{"use strict";a();Object.defineProperty(ur,"__esModule",{value:!0})});var fr=m(de=>{"use strict";a();Object.defineProperty(de,"__esModule",{value:!0});de.DiscoverSectionType=void 0;var pr;(function(r){r[r.featured=0]="featured",r[r.simpleCarousel=1]="simpleCarousel",r[r.prominentCarousel=2]="prominentCarousel",r[r.chapterUpdates=3]="chapterUpdates",r[r.genres=4]="genres"})(pr||(de.DiscoverSectionType=pr={}))});var dr=m(hr=>{"use strict";a();Object.defineProperty(hr,"__esModule",{value:!0})});var mr=m(gr=>{"use strict";a();Object.defineProperty(gr,"__esModule",{value:!0})});var Ir=m(yr=>{"use strict";a();Object.defineProperty(yr,"__esModule",{value:!0})});var wr=m(ge=>{"use strict";a();Object.defineProperty(ge,"__esModule",{value:!0});ge.EndOfPageResults=void 0;ge.EndOfPageResults=Object.freeze({items:[],metadata:void 0})});var xr=m(Sr=>{"use strict";a();Object.defineProperty(Sr,"__esModule",{value:!0})});var Rr=m(Er=>{"use strict";a();Object.defineProperty(Er,"__esModule",{value:!0})});var Pr=m(_r=>{"use strict";a();Object.defineProperty(_r,"__esModule",{value:!0})});var br=m(Br=>{"use strict";a();Object.defineProperty(Br,"__esModule",{value:!0})});var Ar=m(Cr=>{"use strict";a();Object.defineProperty(Cr,"__esModule",{value:!0})});var Mr=m($r=>{"use strict";a();Object.defineProperty($r,"__esModule",{value:!0})});var Qr=m(Fr=>{"use strict";a();Object.defineProperty(Fr,"__esModule",{value:!0})});var vr=m(K=>{"use strict";a();Object.defineProperty(K,"__esModule",{value:!0});K.ContentRating=K.SourceIntents=void 0;var Ur;(function(r){r[r.MANGA_CHAPTERS=1]="MANGA_CHAPTERS",r[r.MANGA_TRACKING=2]="MANGA_TRACKING",r[r.MANGA_PROGRESS=2]="MANGA_PROGRESS",r[r.HOMEPAGE_SECTIONS=4]="HOMEPAGE_SECTIONS",r[r.DISCOVER_SECIONS=4]="DISCOVER_SECIONS",r[r.COLLECTION_MANAGEMENT=8]="COLLECTION_MANAGEMENT",r[r.CLOUDFLARE_BYPASS_REQUIRED=16]="CLOUDFLARE_BYPASS_REQUIRED",r[r.SETTINGS_UI=32]="SETTINGS_UI",r[r.MANGA_SEARCH=64]="MANGA_SEARCH"})(Ur||(K.SourceIntents=Ur={}));var Or;(function(r){r.EVERYONE="SAFE",r.MATURE="MATURE",r.ADULT="ADULT"})(Or||(K.ContentRating=Or={}))});var qr=m(Tr=>{"use strict";a();Object.defineProperty(Tr,"__esModule",{value:!0})});var Nr=m(kr=>{"use strict";a();Object.defineProperty(kr,"__esModule",{value:!0})});var Lr=m(Dr=>{"use strict";a();Object.defineProperty(Dr,"__esModule",{value:!0})});var Hr=m(jr=>{"use strict";a();Object.defineProperty(jr,"__esModule",{value:!0})});var Jr=m(Gr=>{"use strict";a();Object.defineProperty(Gr,"__esModule",{value:!0})});var M=m(w=>{"use strict";a();var fn=w&&w.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),x=w&&w.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&fn(e,r,t)};Object.defineProperty(w,"__esModule",{value:!0});x(rr(),w);x(nr(),w);x(sr(),w);x(cr(),w);x(lr(),w);x(fr(),w);x(dr(),w);x(M(),w);x(mr(),w);x(Ir(),w);x(wr(),w);x(xr(),w);x(Rr(),w);x(Pr(),w);x(br(),w);x(Ar(),w);x(Mr(),w);x(Qr(),w);x(vr(),w);x(qr(),w);x(Nr(),w);x(Lr(),w);x(Hr(),w);x(Jr(),w)});var gn={};pi(gn,{QISCANS_API:()=>Y,QISCANS_API_BASE:()=>A,QISCANS_DOMAIN:()=>ee,QiScans:()=>dn,QiScansExtension:()=>Re});a();var _e=T(M(),1);a();var Ke=T(M(),1);a();a();var Vr=T(M(),1);function ze(r,e){if(e===503)throw new Vr.CloudflareError({url:r.url,method:r.method??"GET"});if(e===403)throw new Error("Server returned 403 Forbidden. This title may have been removed due to a DMCA request or is otherwise unavailable.")}async function O(r){console.log(`[QiScans] fetchJSON: Fetching ${r.url}`);let[e,t]=await Application.scheduleRequest(r);if(console.log(`[QiScans] fetchJSON: Got response status ${e.status}`),ze(r,e.status),e.status!==200)throw new Error(`[QiScans] Request failed with status ${e.status}: ${r.url}`);let i=Application.arrayBufferToUTF8String(t);console.log(`[QiScans] fetchJSON: Data length: ${i.length} chars`),console.log(`[QiScans] fetchJSON: First 200 chars: ${i.substring(0,200)}`);try{let n=typeof i=="string"?JSON.parse(i):i;return console.log("[QiScans] fetchJSON: Successfully parsed JSON"),console.log(`[QiScans] fetchJSON: JSON type: ${typeof n}`),console.log(`[QiScans] fetchJSON: JSON is null: ${n===null}`),n}catch(n){let o=n instanceof Error?n.message:String(n);throw new Error(`[QiScans] Failed to parse JSON from ${r.url}: ${o}`)}}async function Wr(r){let[e,t]=await Application.scheduleRequest(r);ze(r,e.status);let i=Application.arrayBufferToUTF8String(t);return e.status!==200&&console.log(`[QiScans] Non-200 status while fetching text: ${r.url} (status=${e.status})`),typeof i=="string"?i:String(i)}a();function zr(r,e){let t=Array.isArray(r.post?.chapters)?r.post.chapters:[];if(console.log(`[QiScans] parseChapterList: got ${t.length} chapters for ${e.mangaId}`),t.length===0)return console.log("[QiScans] parseChapterList: no chapters found for",e.mangaId),[];let i=[...t].sort((s,u)=>s.number!==u.number?s.number-u.number:new Date(s.createdAt).getTime()-new Date(u.createdAt).getTime()),n=i.filter(s=>!s.isLocked),o=i.length-n.length;return o>0&&console.log(`[QiScans] parseChapterList: filtered out ${o} locked chapters`),n.map((s,u)=>({chapterId:s.slug,sourceManga:e,title:"",chapNum:s.number,volume:0,volumetitle:"",langCode:"en",sortingIndex:u,publishDate:new Date(s.createdAt)}))}function Kr(r,e){let t=/https?:\/\/[^"'\\]*?\/uploads?\/series\/[^"'\\]+?\.(?:webp|jpe?g|png)/gi,i=r.match(t)??[];if(i.length===0)throw console.log(`[QiScans] parseChapterDetails: no matches for uploads/series in mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`),new Error("No chapter page data could be parsed from QiScans for this chapter.");console.log(`[QiScans] parseChapterDetails: found ${i.length} raw image URLs for mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`);let n=i.map(g=>g.replace(/([^:])\/\/+/g,"$1/")),o=Array.from(new Set(n)),s=new Map;for(let g of o){let y=g.replace(/\/[^/?#]+(\?.*)?$/,""),E={url:g},v=s.get(y);v?v.push(E):s.set(y,[E])}if(s.size===0)throw console.log(`[QiScans] parseChapterDetails: after grouping, no dirs for mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`),new Error("No chapter page data could be parsed from QiScans for this chapter.");for(let[g,y]of s.entries())console.log(`[QiScans] parseChapterDetails: dir=${g} has ${y.length} candidate images`);let u=g=>{let y=g.match(/(\d+)\.(?:webp|jpe?g|png)(?:\?|$)/i);return y?Number.parseInt(y[1],10):0},l=400;for(let g of s.values())for(let y of g){let E=r.indexOf(y.url);if(E===-1)continue;let v=E,Pe=Math.min(r.length,E+l),Xe=r.slice(v,Pe).replace(/\\"/g,'"').match(/["']?order["']?\s*:\s*(\d+)/);if(!Xe)continue;let Ze=Number.parseInt(Xe[1],10);Number.isNaN(Ze)||(y.order=Ze)}let f=null,h=null;for(let[g,y]of s.entries())(!h||y.length>h.length)&&(f=g,h=y);if(!f||!h||h.length===0)throw console.log(`[QiScans] parseChapterDetails: no bestDir/bestList for mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`),new Error("No chapter page data could be parsed from QiScans for this chapter.");console.log(`[QiScans] parseChapterDetails: chosen bestDir=${f} with ${h.length} images for mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`);for(let g of h){let y=u(g.url);g.sortKey=g.order??y}let p=h.some(g=>g.order!==void 0);console.log(`[QiScans] parseChapterDetails: first 10 before sort (hasExplicitOrder=${p})`),h.slice(0,10).forEach((g,y)=>{console.log(`[QiScans]   [${y}] url=${g.url} order=${g.order??"none"} fallbackNum=${u(g.url)} sortKey=${g.sortKey??"none"}`)}),p?(h.sort((g,y)=>{let E=g.sortKey??0,v=y.sortKey??0;return E!==v?E-v:g.url.localeCompare(y.url)}),console.log(`[QiScans] parseChapterDetails: applied sort by (order ?? filenameNumber) for mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`)):console.log(`[QiScans] parseChapterDetails: no explicit 'order' fields found; keeping HTML discovery order for mangaId=${e.sourceManga.mangaId}, chapterId=${e.chapterId}`),console.log("[QiScans] parseChapterDetails: first 10 after sort/keep:"),h.slice(0,10).forEach((g,y)=>{console.log(`[QiScans]   [${y}] url=${g.url} order=${g.order??"none"} sortKey=${g.sortKey??"none"}`)});let I=h.map(g=>g.url).map(g=>{let y=g.replace("/file/qiscans/","/");return g!==y&&console.log(`[QiScans] HTML parser fixed URL: ${g} -> ${y}`),y});return{id:e.chapterId,mangaId:e.sourceManga.mangaId,pages:I}}var me=class{mangaProvider;constructor(e){this.mangaProvider=e}async getChapters(e){let t=e.mangaId;if(!e.mangaInfo||!e.mangaInfo.additionalInfo?.postId){console.log(`[QiScans] getChapters: fetching missing metadata for ${t}`);let f=await this.mangaProvider.getMangaDetails(t);e.mangaInfo=f.mangaInfo}let i=e.mangaInfo?.additionalInfo?.postId;if(!i)throw new Error(`[QiScans] getChapters: missing postId for ${t}`);let n=e.mangaInfo?.additionalInfo?.userId,o=new Ke.URL(A).addPathComponent("chapters").setQueryItem("postId",i.toString()).setQueryItem("skip","0").setQueryItem("take","500").setQueryItem("order","desc").setQueryItem("search","");n&&n.trim().length>0&&(o=o.setQueryItem("userId",n));let s=o.toString();console.log("[QiScans] Fetching chapters:",s);let l=await O({url:s,method:"GET"});return zr(l,e)}async getChapterDetails(e){let t=e.sourceManga;if(typeof e.title=="string"&&e.title.trim().toLowerCase().includes("(locked)"))throw new Error("This chapter is locked under QiScans premium (coins required to read).");let n=t.mangaInfo?.shareUrl;if(!n)throw new Error(`[QiScans] Missing shareUrl for mangaId=${t.mangaId}`);let o=n.split("/").filter(Boolean),s=o[o.length-1],u=e.chapterId,l=new Ke.URL(ee).addPathComponent("series").addPathComponent(s).addPathComponent(u).toString();console.log(`[QiScans] Fetching chapter page: ${l}`),console.log(`[QiScans] Series: "${t.mangaId}"`),console.log(`[QiScans] Chapter: ${e.chapNum} (${e.chapterId})`);let f=await Wr({url:l,method:"GET"}),h=f.match(/"images":\s*\[([^\]]+)\]/);if(h)try{console.log(`[QiScans] Raw JSON match length: ${h[1].length} chars`);let p=`[${h[1]}]`,S=JSON.parse(p);console.log(`[QiScans] Parsed ${S.length} images`),S.slice(0,3).forEach((g,y)=>{console.log(`[QiScans] Image ${y}: order=${g.order}, url=${g.url}`)});let I=S.sort((g,y)=>g.order-y.order).map(g=>g.url).map(g=>{let y=g;return y.includes("/file/qiscans/")&&(y=y.replace("/file/qiscans/","/"),console.log("[QiScans] Applied fix 1: removed /file/qiscans/")),g!==y&&console.log(`[QiScans] Fixed URL: ${g} -> ${y}`),y});return console.log(`[QiScans] Final: ${I.length} pages`),I.length>0&&(console.log(`[QiScans] First page: ${I[0]}`),console.log(`[QiScans] Last page: ${I[I.length-1]}`)),{id:e.chapterId,mangaId:t.mangaId,pages:I}}catch(p){let S=p instanceof Error?p.message:String(p);console.log(`[QiScans] Failed to parse embedded JSON: ${S}`),console.log(`[QiScans] First 500 chars of match: ${h[1].substring(0,500)}`)}else{console.log('[QiScans] No "images": array found in HTML'),console.log("[QiScans] Searching for alternative patterns...");let p=f.match(/https:\/\/[^"'\s]+\.(?:webp|jpg|png)/g);p&&(console.log(`[QiScans] Found ${p.length} image URLs in HTML`),console.log(`[QiScans] Sample URLs: ${p.slice(0,3).join(", ")}`))}return console.log("[QiScans] Falling back to HTML parsing"),Kr(f,e)}};a();var G=T(M(),1);a();a();function F(r){let e=r.replace(/[^a-zA-Z0-9._\-@()[\]%?#+=/&:]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");if(!e)throw new Error(`[QiScans] sanitizeId: cannot derive valid identifier from "${r}"`);return e}a();var te={},hn=500,ye=[];function Ie(r,e){let t=e??F(r.slug);if(ye.length>=hn&&!te[t]){let i=ye.shift();i&&delete te[i]}te[t]=r,ye.includes(t)||ye.push(t)}function Yr(r){return te[r]||te[F(r)]}function Xr(r,e){let t=r.data??[];if(console.log(`[QiScans] parseDiscoverItems: sectionType="${e}", posts count=${t.length}`),t.length===0)return console.log("[QiScans] parseDiscoverItems: No posts in response"),[];let i=t.map((n,o)=>{let s=F(n.slug),u=n.featuredImage||"";if(u.includes("/file/qiscans/")){let f=u.replace("/file/qiscans/","/");o<3&&console.log(`[QiScans] Fixed image URL for "${n.postTitle}"`),u=f}if(Ie(n,s),e==="latest"){let f=n.chapters?.[0],h={type:"chapterUpdatesCarouselItem",mangaId:s,chapterId:f?.slug||"",title:Application.decodeHTMLEntities(n.postTitle),imageUrl:u,subtitle:f?`Ch. ${f.number}`:`${n._count?.chapters??0} Chapters`};return o<3&&console.log(`[QiScans] Item ${o}: chapterUpdatesCarouselItem - ${h.title}`),h}let l={type:"simpleCarouselItem",mangaId:s,title:Application.decodeHTMLEntities(n.postTitle),imageUrl:u,subtitle:`${n._count?.chapters??0} Chapters`};return o<3&&console.log(`[QiScans] Item ${o}: simpleCarouselItem - ${l.title}`),l});return console.log(`[QiScans] parseDiscoverItems: returning ${i.length} items`),i}var we=class{async getDiscoverSections(){return[{id:"featured",title:"Featured",type:G.DiscoverSectionType.prominentCarousel},{id:"popular",title:"Popular Today",type:G.DiscoverSectionType.simpleCarousel},{id:"pinned",title:"Pinned",type:G.DiscoverSectionType.simpleCarousel},{id:"latest",title:"Latest Updates",type:G.DiscoverSectionType.chapterUpdates},{id:"editors-pick",title:"Editor's Pick",type:G.DiscoverSectionType.simpleCarousel},{id:"new",title:"New Fresh Series",type:G.DiscoverSectionType.simpleCarousel}]}async getDiscoverSectionItems(e,t){let i=t?.page??1,n=15,o=0,s;switch(e.id){case"featured":n=25,o=10,s=`${A}/v2/posts?featured=true&perPage=${n}&page=${i}`;break;case"popular":s=`${A}/v2/posts?sortBy=totalViews&sortOrder=desc&perPage=${n}&page=${i}`;break;case"pinned":s=`${A}/v2/posts?pinned=true&perPage=${n}&page=${i}`;break;case"latest":s=`${A}/v2/posts?sortBy=lastChapterAddedAt&sortOrder=desc&perPage=${n}&page=${i}`;break;case"editors-pick":n=40,o=25,s=`${A}/v2/posts?editorsPick=true&perPage=${n}&page=${i}`;break;case"new":s=`${A}/v2/posts?sortBy=createdAt&sortOrder=desc&perPage=${n}&page=${i}`;break;default:throw new Error(`[QiScans] Unknown discover section: ${e.id}`)}console.log(`[QiScans] Fetching discover section "${e.id}" page ${i}: ${s}`);try{let l=await O({url:s,method:"GET"}),f=Xr(l,e.id);o>0&&f.length>o&&(console.log(`[QiScans] Skipping first ${o} items for "${e.id}"`),f=f.slice(o));let p=(e.id==="pinned"||e.id==="latest")&&f.length>=15;return{items:f,metadata:p?{page:i+1}:void 0}}catch(u){throw console.error(`[QiScans] Error in getDiscoverSectionItems for "${e.id}":`,u),u}}};a();var ei=T(M(),1);a();var Zr=T(M(),1);function re(r){let e=r.author?.trim(),t=r.artist?.trim();return{mangaId:F(r.slug),mangaInfo:{primaryTitle:Application.decodeHTMLEntities(r.postTitle),secondaryTitles:r.alternativeTitles?r.alternativeTitles.split(/, ?/).map(i=>i.trim()).filter(i=>i.length>0):[],thumbnailUrl:(r.featuredImage||"https://qiscans.org/wp-content/uploads/2023/05/qiscans-logo.png").replace("/file/qiscans/","/"),synopsis:Application.decodeHTMLEntities(r.postContent.replace(/<[^>]+>/g,"")),...e?{author:e}:{},...t?{artist:t}:{},status:r.seriesStatus??"UNKNOWN",contentRating:Zr.ContentRating.EVERYONE,tagGroups:r.genres&&r.genres.length>0?[{id:"genres",title:"Genres",tags:r.genres.map(i=>({id:i.id.toString(),title:i.name}))}]:[],additionalInfo:{postId:r.id.toString(),slug:r.slug},shareUrl:`https://qiscans.org/series/${r.slug}`}}}var Se=class{async getMangaDetails(e){let t=Yr(e);if(t){if(console.log(`[QiScans] MangaProvider: cached.id = ${t.id}`),console.log(`[QiScans] MangaProvider: cached.genres = ${JSON.stringify(t.genres)}`),console.log(`[QiScans] MangaProvider: genres length = ${t.genres?.length??"undefined"}`),(!t.genres||t.genres.length===0)&&t.id){console.log(`[QiScans] MangaProvider: cached post for "${e}" has no genres, fetching by ID ${t.id}`);try{let I={url:`${A}/v2/posts/${t.id}`,method:"GET"},g=await O(I);if(g)return console.log(`[QiScans] MangaProvider: fetched full data by ID ${t.id}`),re(g)}catch(S){let I=S instanceof Error?S.message:String(S);return console.log(`[QiScans] MangaProvider: failed to fetch by ID, using cached data: ${I}`),re(t)}}return console.log(`[QiScans] MangaProvider: using cached post for mangaId="${e}" (slug="${t.slug}")`),re(t)}let n=e.replace(/^\d+-/,""),o=n.replace(/-/g," ").trim();if(!o||o.length<2)throw new Error(`[QiScans] MangaProvider: cannot derive valid search term from mangaId "${e}"`);let s=encodeURIComponent(o).replace(/%20/g,"-").replace(/%2B/g,"-"),l=`${new ei.URL(Y).setQueryItem("perPage","20").setQueryItem("page","1").toString()}&searchTerm=${s}`;console.log(`[QiScans] MangaProvider: cache miss for "${e}", fallback searchTerm="${s}" -> ${l}`);let h=await O({url:l,method:"GET"});if(!h.posts||h.posts.length===0)throw new Error(`[QiScans] No posts found for id "${e}" (fallback searchTerm="${s}")`);let p=h.posts.find(S=>F(S.slug)===e);if(p||(p=h.posts.find(S=>S.slug.replace(/^\d+-/,"")===n)),!p)throw new Error(`[QiScans] MangaProvider: no reliable matching manga found for "${e}" after fallback searchTerm="${s}".`);return re(p)}};a();var Ye=T(M(),1);a();var ti=T(M(),1);function ri(r){return(r.posts??[]).map(e=>{let t=F(e.slug);console.log(`[QiScans] Search result: "${e.postTitle}"`),console.log(`[QiScans] Image URL: ${e.featuredImage}`);let i=e.featuredImage||"";if(i.includes("/file/qiscans/")){let n=i.replace("/file/qiscans/","/");console.log(`[QiScans] Fixed cover image: ${i} -> ${n}`),i=n}return Ie(e,t),{mangaId:t,title:Application.decodeHTMLEntities(e.postTitle),imageUrl:i,subtitle:`${e._count?.chapters??0} Chapters`,contentRating:ti.ContentRating.EVERYONE}})}var ii=20,xe=class{async getSearchResults(e,t){let i=t?.page??1,n=(e.title??"").trim().replace(/[]/g,"'").replace(/[]/g,'"').replace(/ /g,"-"),o=new Ye.URL(Y).setQueryItem("perPage",ii.toString()).setQueryItem("page",i.toString()).toString(),s=n?`${o}&searchTerm=${encodeURIComponent(n).replace(/%20/g,"+").replace(/%2B/g,"+")}`:o;console.log(`[QiScans] Fetching search page ${i} from QiScans API`);let l=await O({url:s,method:"GET"}),f=ri(l),h=l,p=!1;if(typeof h.hasMore=="boolean")p=h.hasMore;else if(typeof h.total=="number")p=i*ii<h.total;else try{let S=new Ye.URL(Y).setQueryItem("perPage","1").setQueryItem("page",(i+1).toString()).toString(),I=encodeURIComponent(n).replace(/%20/g,"+").replace(/%2B/g,"+"),y={url:n?`${S}&searchTerm=${I}`:S,method:"GET"},E=await O(y);p=Array.isArray(E.posts)&&E.posts.length>0}catch{p=!1}return{items:f,metadata:p?{page:i+1}:void 0}}};a();var ni=T(M(),1);var Ee=class extends ni.PaperbackInterceptor{async interceptRequest(e){return e.headers=e.headers??{},e.headers.referer=`${ee}/`,console.log(`[QiScans] Interceptor adding referer to: ${e.url}`),e}async interceptResponse(e,t,i){return i}};var ee="https://qiscans.org",Y="https://api.qiscans.org/api/query",A="https://api.qiscans.org/api",Re=class{searchProvider=new xe;mangaProvider=new Se;chapterProvider=new me(this.mangaProvider);discoverProvider=new we;cookieStorageInterceptor=new _e.CookieStorageInterceptor({storage:"stateManager"});globalRateLimiter=new _e.BasicRateLimiter("rateLimiter",{numberOfRequests:6,bufferInterval:1,ignoreImages:!0});qiscansInterceptor=new Ee("qiscans-interceptor");async initialise(){this.globalRateLimiter.registerInterceptor(),this.cookieStorageInterceptor.registerInterceptor(),this.qiscansInterceptor.registerInterceptor()}async saveCloudflareBypassCookies(e){for(let t of e)(t.name.startsWith("cf")||t.name.startsWith("_cf")||t.name.startsWith("__cf"))&&this.cookieStorageInterceptor.setCookie(t)}async getSearchFilters(){return[]}async getSearchResults(e,t){return this.searchProvider.getSearchResults(e,t)}async getMangaDetails(e){return this.mangaProvider.getMangaDetails(e)}async getChapters(e){return this.chapterProvider.getChapters(e)}async getChapterDetails(e){return this.chapterProvider.getChapterDetails(e)}async getDiscoverSections(){return this.discoverProvider.getDiscoverSections()}async getDiscoverSectionItems(e,t){return this.discoverProvider.getDiscoverSectionItems(e,t)}async bypassCloudflareRequest(e){return e}},dn=new Re;return fi(gn);})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
